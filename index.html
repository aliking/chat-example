<!doctype html>
<html>
<head>
  <title>Socket.IO chat</title>
  <link rel="stylesheet" type="text/css" href="/components/style.css" />
  <link rel="stylesheet" type="text/css" href="/components/jquery.vintageTxt.css" />
  <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
  <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
  <script src="/components/jquery.vintageTxt.js"></script>

  <script>
  socket.on('countdown', function(){
    $('#countdown').show();
  });
  </script>

  <script>
  var socket = io();
  var msgQueue = [];
  var typing = false;
  var tSpeed = 100;
  var lPause = 2000;

  function printMsg() {
    if(!typing) {
      var msg = msgQueue.pop();

      if(msg) {
        typing = true;
        if (typeof msg === 'string'){msg = [msg]};
        console.log(msg);
        $('#console').vintageTxt({
          text: msg,
          textSpeed: tSpeed,
          linePause: lPause,
          promptEnabled: false,
          'onFinishedTyping' : function(){
            tSpeed = 20;
            lPause = 50;
            typing = false;
            setTimeout(function(){
              printMsg();
            }, 1000);
          }
        })
      }
    }
  }

  socket.on('console', function(msg){
    console.log(msg);
    msgQueue.unshift(msg);
    printMsg();
  });
  </script>
</head>
<body>

  <div id="columns">
    <div id="column1">
      <canvas id="planetary-monitor" class="panel" width="300" height="300"></canvas>
      <div class="panel holder"></div>
      <div class="panel holder"></div>
    </div>

    <div id="column2">
      <div id="console" class="panel"></div>
      <div class="panel holder"></div>
    </div>

    <div id="column3">
      <div class="panel holder"></div>
      <div id='boxes' class='panel'>

      </div>
      <div id='console2' class="panel">

      </div>
    </div>

    <script src="/components/planetary-monitor.js"></script>
    <script src="/components/box-panel.js"></script>

    <script src="/components/nonsense-ticker.js"></script>

  </body>
  </html>
